{"visual":{"name":"customMatrix","displayName":"CustomMatrix","guid":"customMatrix65190D7E3EF14C42BD007796160B5437","visualClassName":"Visual","version":"1.0.0","description":"Tabla para analisis de competitividad","supportUrl":"N/A","gitHubUrl":""},"author":{"name":"Jaime Guerra","email":"jaime.guerra.pe@gmail.com"},"apiVersion":"5.1.0","style":"style/visual.less","stringResources":{},"capabilities":{"dataRoles":[{"displayName":"Categorias","name":"category","kind":"Grouping"},{"displayName":"Medidas","name":"measure","kind":"Measure"}],"sorting":{"custom":{}},"objects":{"dataPoint":{"properties":{"defaultColor":{"type":{"fill":{"solid":{"color":true}}}},"showAllDataPoints":{"type":{"bool":true}},"fill":{"type":{"fill":{"solid":{"color":true}}}},"fillRule":{"type":{"fill":{}}},"fontSize":{"type":{"formatting":{"fontSize":true}}}}}},"dataViewMappings":[{"categorical":{"categories":{"for":{"in":"category"},"dataReductionAlgorithm":{"top":{}}},"values":{"select":[{"bind":{"to":"measure"}}]}}}],"privileges":[]},"content":{"js":"var customMatrix65190D7E3EF14C42BD007796160B5437;(()=>{\"use strict\";var t={856:(t,e,d)=>{d.d(e,{u:()=>o});class o{constructor(t){this.container=document.createElement(\"div\"),this.container.className=\"customMatrixContainer\",t.element.appendChild(this.container)}update(t){this.container.innerHTML=\"\";const e=t.dataViews[0].categorical,d=e.values,o=e.categories[0].values;let i=\"<tr>\";i+='<th rowspan=\"2\">Estado</th>',i+=`<th rowspan=\"2\">${d[0].source.displayName}</th>`,i+='<th colspan=\"3\">Mercado</th>',i+='<th colspan=\"3\">Farmacias (FP)</th>',i+='<th colspan=\"3\">Independientes (IND)</th>',i+='<th colspan=\"3\">Resto Cadenas (RC)</th>',i+='<th colspan=\"3\">Market Share (MS)</th>',i+='<th colspan=\"3\">Crecimiento MS</th>',i+=\"</tr>\",i+=\"<tr>\",i+=\"<th>Anterior</th>\",i+=\"<th>Actual</th>\",i+=\"<th>Crec.</th>\",i+=\"<th>Anterior</th>\",i+=\"<th>Actual</th>\",i+=\"<th>Crec.</th>\",i+=\"<th>Anterior</th>\",i+=\"<th>Actual</th>\",i+=\"<th>Crec.</th>\",i+=\"<th>Anterior</th>\",i+=\"<th>Actual</th>\",i+=\"<th>Crec.</th>\",i+=\"<th>FP</th>\",i+=\"<th>IND</th>\",i+=\"<th>RC</th>\",i+=\"<th>FP</th>\",i+=\"<th>IND</th>\",i+=\"<th>RC</th>\",i+=\"</tr>\";let a=\"\",l=0,n=0,r=0,s=0,u=0,c=0,h=0,m=0,x=0,$=0,F=0,g=0,b=0,p=0,v=0,S=0,N=0,V=0,L=0;const C=o.map(((t,e)=>({dimension:String(t),aValue:d[0].values[e],bValue:d[1].values[e],cValue:d[2].values[e],eValue:d[3].values[e],fValue:d[4].values[e],hValue:d[5].values[e],iValue:d[6].values[e],kValue:d[7].values[e],lValue:d[8].values[e]})));C.sort(((t,e)=>t.dimension<e.dimension?-1:t.dimension>e.dimension?1:0));for(let t=0;t<C.length;t++){let e=`<tr><td class=\"rh\">${C[t].dimension}</td>`,d=C[t].aValue,o=C[t].bValue/1e6,i=C[t].cValue/1e6,s=100*(i/o-1),h=C[t].eValue/1e6,$=C[t].fValue/1e6,b=100*($/h-1),p=C[t].hValue/1e6,v=C[t].iValue/1e6,S=100*(v/p-1),N=C[t].kValue/1e6,V=C[t].lValue/1e6,L=100*(V/N-1),M=$/i*100,y=v/i*100,f=V/i*100,D=M-h/o*100,E=y-p/o*100,w=f-N/o*100;l+=d,n+=o,r+=i,u+=h,c+=$,m+=p,x+=v,F+=N,g+=V,e+=`<td>${Number(d.toFixed(0)).toLocaleString()}</td>`,e+=`<td>${Number(o.toFixed(1)).toLocaleString()} mill.</td>`,e+=`<td>${Number(i.toFixed(1)).toLocaleString()} mill.</td>`,e+=`<td class=\"${s>0?\"good\":\"bad\"}\">${s.toFixed(1)} %</td>`,e+=b?`<td>${Number(h.toFixed(1)).toLocaleString()} mill.</td>`:\"<td></td>\",e+=b?`<td>${Number($.toFixed(1)).toLocaleString()} mill.</td>`:\"<td></td>\",e+=b?`<td class=\"${b>0?\"good\":\"bad\"}\">${b.toFixed(1)} %</td>`:\"<td></td>\",e+=`<td>${Number(p.toFixed(1)).toLocaleString()} mill.</td>`,e+=`<td>${Number(v.toFixed(1)).toLocaleString()} mill.</td>`,e+=`<td class=\"${S>0?\"good\":\"bad\"}\">${S.toFixed(1)} %</td>`,e+=`<td>${Number(N.toFixed(1)).toLocaleString()} mill.</td>`,e+=`<td>${Number(V.toFixed(1)).toLocaleString()} mill.</td>`,e+=`<td class=\"${L>0?\"good\":\"bad\"}\">${L.toFixed(1)} %</td>`,e+=b?`<td>${M.toFixed(1)} %</td>`:\"<td></td>\",e+=`<td>${y.toFixed(1)} %</td>`,e+=`<td>${f.toFixed(1)} %</td>`,e+=b?`<td class=\"${D>0?\"good\":\"bad\"}\">${D.toFixed(1)} %</td>`:\"<td></td>\",e+=`<td class=\"${E>0?\"good\":\"bad\"}\">${E.toFixed(1)} %</td>`,e+=`<td class=\"${w>0?\"good\":\"bad\"}\">${w.toFixed(1)} %</td>`,e+=\"</tr>\",a+=e}s=100*(r/n-1),h=100*(c/u-1),$=100*(x/m-1),b=100*(g/F-1),p=c/r*100,v=x/r*100,S=g/r*100,N=p-u/n*100,V=v-m/n*100,L=S-F/n*100,a+=`<tr class=\"totalRow\">\\n                            <td style=\"text-align: center\">Total</td>\\n                            <td>${Number(l.toFixed(0)).toLocaleString()}</td>\\n                            <td>${Number(n.toFixed(1)).toLocaleString()} mill.</td>\\n                            <td>${Number(r.toFixed(1)).toLocaleString()} mill.</td>\\n                            <td>${s.toFixed(1)} %</td>\\n                            <td>${Number(u.toFixed(1)).toLocaleString()} mill.</td>\\n                            <td>${Number(c.toFixed(1)).toLocaleString()} mill.</td>\\n                            <td>${h.toFixed(1)} %</td>\\n                            <td>${Number(m.toFixed(1)).toLocaleString()} mill.</td>\\n                            <td>${Number(x.toFixed(1)).toLocaleString()} mill.</td>\\n                            <td>${$.toFixed(1)} %</td>\\n                            <td>${Number(F.toFixed(1)).toLocaleString()} mill.</td>\\n                            <td>${Number(g.toFixed(1)).toLocaleString()} mill.</td>\\n                            <td>${b.toFixed(1)} %</td>\\n                            <td>${p.toFixed(1)} %</td>\\n                            <td>${v.toFixed(1)} %</td>\\n                            <td>${S.toFixed(1)} %</td>\\n                            <td>${N.toFixed(1)} %</td>\\n                            <td>${V.toFixed(1)} %</td>\\n                            <td>${L.toFixed(1)} %</td>\\n                        </tr>`;const M=`\\n            <table class=\"customMatrix\">\\n                <thead>\\n                ${i}\\n                </thead>\\n                <tbody>\\n                ${a}\\n                </tbody>\\n            </table>\\n        `;this.container.innerHTML=M}}},738:t=>{t.exports=Function(\"return this\")()}},e={};function d(o){var i=e[o];if(void 0!==i)return i.exports;var a=e[o]={exports:{}};return t[o](a,a.exports,d),a.exports}d.d=(t,e)=>{for(var o in e)d.o(e,o)&&!d.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},d.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),d.r=t=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})};var o={};(()=>{d.r(o),d.d(o,{default:()=>a});var t=d(856),e=d(738).powerbi,i={name:\"customMatrix65190D7E3EF14C42BD007796160B5437\",displayName:\"CustomMatrix\",class:\"Visual\",apiVersion:\"5.1.0\",create:e=>{if(t.u)return new t.u(e);throw\"Visual instance not found\"},createModalDialog:(t,e,d)=>{const o=globalThis.dialogRegistry;t in o&&new o[t](e,d)},custom:!0};void 0!==e&&(e.visuals=e.visuals||{},e.visuals.plugins=e.visuals.plugins||{},e.visuals.plugins.customMatrix65190D7E3EF14C42BD007796160B5437=i);const a=i})(),customMatrix65190D7E3EF14C42BD007796160B5437=o})();","css":".customMatrixContainer {\n  overflow: auto;\n  font-family: \"Segoe UI\", Arial, sans-serif;\n  font-size: 12px;\n}\n.customMatrix {\n  border-collapse: collapse;\n  width: 100%;\n  font-size: 11px;\n}\n.customMatrix th,\n.customMatrix td {\n  border: 1px solid #ccc;\n  padding: 3px;\n  text-align: center;\n  border: 1px solid white;\n}\n.customMatrix th {\n  background-color: #f2f2f2;\n  font-weight: bold;\n  font-size: 12px;\n}\n.customMatrix td {\n  text-align: right;\n}\n.customMatrix tr:hover {\n  background-color: #ddd;\n}\n.customMatrix .totalRow {\n  background-color: #f2f2f2;\n  font-weight: bold;\n}\n.customMatrix td.bad {\n  background-color: #FFD5D5;\n  color: #D64550;\n  font-weight: bold;\n}\n.customMatrix td.good {\n  background-color: #DCFFD4;\n  color: #10AE8E;\n  font-weight: bold;\n}\n.customMatrix td.rh {\n  background-color: #f2f2f2;\n  color: black;\n  font-weight: bold;\n  text-align: left;\n}\n\n","iconBase64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3NEY1QjA1NUQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3NEY1QjA1NEQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5Mjk5RDU1ODBGRDRFMDExQTcxQ0JFODI3ODBCQUE5RSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PpDoNX0AAAI3SURBVHjarJRLSFVRFIY9t7SiRDGLoEEPCRJRaCSYkxCiFCXCF+LIMExQLkilgumgwkbdBuWDRC2EomhURCOjgagkXEgKLUKhidobM6H0+i34rxyPnuvEA5/rXPda/1l7739vJxKJxG3ls93+hEKhTILxJhgMftmsiPxdhHw4CfepeR8dCyjWwwB0kZy3iVgCoQ2ewnmXxhrBD7Cgr/ZQVA17fDRPw2UYhzK6G99IsBse6/0QNME+H8FT4EA/YiPqOgA1q4IMzBNuw6iKjkCpj+Av+AdnEEmD3bxfhzvuDk30HaEaLsEkXCO53rN+Bwg5qsvTuj/TjGYtx9nINhRmEx7AYWiFW7AXOuEcbPOUvIZ2mnrl+PkQUbNEh4QHNKUSDdsSBWEOlmxTEfvs26FL9Khe211if6Acgee+xo7xzMgBxfq9qPe3fgWBGN2lEnqtG9nExM7CV3jp3bDos2bKJB0nHFRxAxRpA/5CIXyHh5ABv6GZqd9dJ6iz2SjbxMMypGhJFtTlNzu3kK7xgDxpove8U66FK2A+s6nul5gVVMEL+Ak7lG/T+g9JcIOGar2CRUoogxMwpP/bLTJMB9bRhDbkk5bBUU0y3ES0xS04CBfN9RSHiY90vJK0BHaSzG9h2eejS3RJeVfdtrGzuGyd8CX7Yq6ExuCH63jaVMPkFOv6OibB6DKs2+VEQp+WYBoqERn2sVWWRNN0YurIfeL14U6YkpkLYCSG6e0yqdCxvKBLIm5FgAEAV0nKuwMYRUsAAAAASUVORK5CYII="},"visualEntryPoint":"","toolsVersion":null}